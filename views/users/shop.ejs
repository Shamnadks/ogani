<% if(typeof userData !=="undefined"){%>        
    <%-include("../layouts/userheaderlogout")%>
  <%}else{%>
    <%-include('../layouts/userheader')%>
  <%}%>
  <style>
    .pagination {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
    
    .pagination-link {
      color: #333;
      padding: 8px 16px;
      margin: 0 4px;
      border-radius: 4px;
      text-decoration: none;
      background-color: #f2f2f2;
    }
    
    .pagination-link:hover {
      background-color: #ddd;
    }
    
    .pagination-link.active {
      background-color: #4CAF50;
      color: white;
    }
  </style>
        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <div class="header__logo">
                        <a href="./index.html"><img src="img/logo.png" alt=""></a>
                    </div>
                </div>
                <div class="col-lg-6">
                    <nav class="header__menu">
                        <ul>
                            <li><a href="/home">Home</a></li>
                            <li class="/shop"><a href="./shop-grid.html">Shop</a></li>

                            <li><a href="./blog.html">Blog</a></li>
                            <li><a href="./contact.html">Contact</a></li>
                        </ul>
                    </nav>
                </div>
                <div class="col-lg-3">
                    <div class="header__cart">
                        <ul>
                            <li><a href="/wishlist"><i class="fa fa-heart"></i></a></li>
                            <li><a href="/cart"><i class="fa fa-shopping-bag"></i> </a></li>
                        </ul>
                        <div class="header__cart__price">item: <span>Rs 150.00</span></div>
                    </div>
                </div>
            </div>
            <div class="humberger__open">
                <i class="fa fa-bars"></i>
            </div>
        </div>
    </header>
    <!-- Header Section End -->

    <!-- Hero Section Begin -->
   
    <section class="hero hero-normal">
        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    
                    <div class="hero__categories">
                        <div class="hero__categories__all">
                            <i class="fa fa-bars"></i>
                            <span>All CATEGORY</span>
                        </div>
                        
                        <ul>
                            <% if(category.length > 0){%>                
                  
                                <% for(let k=0;k < category.length; k++){%>
                            <li><a href="/shop?id=<%= category[k]._id %>"><%= category[k].name %></a></li>
                            <%}%>
                            <%}%>
                           
                        </ul>
                       
                    </div>
                </div>
               
                
                <div class="col-lg-9">
                    <div class="hero__search">
                        <div class="hero__search__form">
                            <form >
                                
                                <input type="text" id="search" name="search" placeholder="What do yo u need?">
                                <button type="submit" class="site-btn">SEARCH</button>
                            </form>
                        </div>
                    </div>
                </div>
                
              
            </div>
        </div>
    </section>
   
   
      
      
   
    <!-- Hero Section End -->

    <!-- Breadcrumb Section Begin -->
    <section class="breadcrumb-section set-bg" data-setbg="img/breadcrumb.jpg">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <div class="breadcrumb__text">
                        <h2>Organi Shop</h2>
                        <div class="breadcrumb__option">
                            <a href="./index.html">Home</a>
                            <span>Shop</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Section End -->

    <!-- Product Section Begin -->
    <section class="product spad">
        <div class="container">
            <div class="row">
               
                <div class="col-lg-12 col-md-12">
                    
                    <div class="filter__item">
                        <div class="row">
                            <div class="col-lg-4 col-md-5">
                                <div class="filter__sort">
                                  
                                   
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-4">
                                <div class="filter__found">
                                    <h6><span><%=products.length %></span> Products found</h6>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-3">
                                <div class="filter__option">
                                    <span class="icon_grid-2x2"></span>
                                    <span class="icon_ul"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <% if(products.length> 0){%>                
                  
                            <% for(let i=0;i < products.length; i++){%>
                        <div class="col-lg-4 col-md-6 col-sm-6">
                            <div class="product__item">
                                <div class="product__item__pic set-bg" data-setbg="/images/<%=products[i].img1[0]%>">
                                    <ul class="product__item__pic__hover">
                                        <li><a  onclick="addtowishlist('<%= products[i]._id %>')"  ><i class="fa fa-heart"></i></a></li>
                                        <li><a href="/details?id=<%= products[i]._id%>"><i class="fa fa-retweet"></i></a></li>
                                        <li><a onclick=" addtocart('<%= products[i]._id %>')" ><i class="fa fa-shopping-cart"></i></a></li>
                                    </ul>
                                </div>
                                <div class="product__item__text">
                                    <h6><a href="#"><%= products[i].productName%></a></h6>
                                    <h5>Rs.<%= products[i].price %></h5>
                                </div>
                               
                            </div>
                            
                        </div>
                        <%}%>
                   <%}%>
                
                        
                    </div>
                    <div class="product__pagination">
                       
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div class="pagination">
        <% if(currentpage > 1){ %>
          <a class="pagination-link" href="?page=<%= currentpage - 1 %>&id=<%= category_id %>">Previous</a>
        <% } %>
        <% for(let j=1;j<=totalpage;j++){ %>
          <a class="pagination-link <%= currentpage == j ? 'is-current' : '' %>" href="?page=<%= j %>&id=<%= category_id %>"><%= j %></a>
        <% } %>
        <% if(currentpage < totalpage){ %>
          <a class="pagination-link" href="?page=<%= parseInt(currentpage) + 1 %>&id=<%= category_id %>">Next</a>
        <% } %>
      </div>
      
      
    <!-- Product Section End -->

    <!-- Footer Section Begin -->
    <footer class="footer spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="footer__about">
                        <div class="footer__about__logo">
                            <a href="./index.html"><img src="img/logo.png" alt=""></a>
                        </div>
                        <ul>
                            <li>Address: 60-49 Road 11378 New York</li>
                            <li>Phone: +65 11.188.888</li>
                            <li>Email: hello@colorlib.com</li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 col-sm-6 offset-lg-1">
                    <div class="footer__widget">
                        <h6>Useful Links</h6>
                        <ul>
                            <li><a href="#">About Us</a></li>
                            <li><a href="#">About Our Shop</a></li>
                            <li><a href="#">Secure Shopping</a></li>
                            <li><a href="#">Delivery infomation</a></li>
                            <li><a href="#">Privacy Policy</a></li>
                            <li><a href="#">Our Sitemap</a></li>
                        </ul>
                        <ul>
                            <li><a href="#">Who We Are</a></li>
                            <li><a href="#">Our Services</a></li>
                            <li><a href="#">Projects</a></li>
                            <li><a href="#">Contact</a></li>
                            <li><a href="#">Innovation</a></li>
                            <li><a href="#">Testimonials</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-4 col-md-12">
                    <div class="footer__widget">
                        <h6>Join Our Newsletter Now</h6>
                        <p>Get E-mail updates about our latest shop and special offers.</p>
                        <form action="#">
                            <input type="text" placeholder="Enter your mail">
                            <button type="submit" class="site-btn">Subscribe</button>
                        </form>
                        <div class="footer__widget__social">
                            <a href="#"><i class="fa fa-facebook"></i></a>
                            <a href="#"><i class="fa fa-instagram"></i></a>
                            <a href="#"><i class="fa fa-twitter"></i></a>
                            <a href="#"><i class="fa fa-pinterest"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="footer__copyright">
                        <div class="footer__copyright__text"><p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
  <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p></div>
                        <div class="footer__copyright__payment"><img src="img/payment-item.png" alt=""></div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->

    <!-- Js Plugins -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/jquery.slicknav.js"></script>
    <script src="js/mixitup.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>

<script>
    async function addtowishlist(productId){
        let orderplacement = await fetch("/addtowishlist", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(
                {
                    productId:productId  
                }
                ),
          });
          let result = await orderplacement.json();
          console.log("harsendra raj testing" + result);
          if (result.res === "success") {
            Swal.fire({
              title: "Success",
              text: "Item added successfully !",
              icon: "success",
              confirmButtonColor: "#3085d6",
              cancelButtonColor: "#d33",
              confirmButtonText: "OK",
              timer: 3000,
            })
          } else {
            Swal.fire({
              title: "Something went wrong",
              text: "something went wrong !",

              icon: "failure",
              confirmButtonColor: "#3085d6",
              cancelButtonColor: "#d33",
              confirmButtonText: "OK",
              timer: 3000,
            }).then((res) => {
              window.location.href = "/shop";
            });
          }
    }
</script>

<script>
    async function addtocart(productId){
      
        let orderplacement = await fetch("/addtocart", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(
                {
                    productId:productId  
                }
                ),
          });
          let result = await orderplacement.json()
          
          if (result.res === "success") {
            Swal.fire({
              title: "Success",
              text: "Item added successfully !",
              icon: "success",
              confirmButtonColor: "#3085d6",
              cancelButtonColor: "#d33",
              confirmButtonText: "OK",
              timer: 3000,
            })
          } else {
            Swal.fire({
              title: "Something went wrong",
              text: "something went wrong !",

              icon: "failure",
              confirmButtonColor: "#3085d6",
              cancelButtonColor: "#d33",
              confirmButtonText: "OK",
              timer: 3000,
            }).then((res) => {
              window.location.href = "/shop";
            });
          }
          
          
          }
    
</script>
<script>
    const sortForm = document.getElementById('sort-form');
    console.log(sortForm);
  
    if (sortForm) {
      const sortBySelect = sortForm.querySelector('[name="sortBy"]');
      console.log(sortBySelect);
  
      if (sortBySelect) {
        sortBySelect.addEventListener('change', function() {
          sortForm.submit();
        });
      }
    }
  </script>
  
  


</body>

</html>